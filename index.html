<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>SOUL PLUS STORE</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="soul-icon.png">

    <style>
        :root { --bg: #0a192f; --card: #172a45; --accent: #64ffda; --text: #ccd6f6; }
        body { background: var(--bg); color: var(--text); font-family: -apple-system, sans-serif; margin: 0; padding: env(safe-area-inset-top) 15px 40px; }
        
        header { text-align: center; padding: 30px 0; }
        header img { width: 90px; border-radius: 22px; box-shadow: 0 0 25px rgba(100,255,218,0.2); }
        header h1 { font-size: 26px; margin: 15px 0 5px; color: #fff; }

        .app-grid { display: grid; gap: 15px; max-width: 500px; margin: auto; }
        .app-card { background: var(--card); border-radius: 20px; padding: 15px; display: flex; align-items: center; justify-content: space-between; border: 1px solid #233554; transition: 0.3s; }
        .app-card:active { transform: scale(0.98); background: #1d3557; }
        
        .app-main { display: flex; align-items: center; gap: 15px; }
        .app-img { width: 60px; height: 60px; border-radius: 15px; object-fit: cover; background: #0a192f; border: 1px solid #233554; }
        .app-title { font-weight: bold; font-size: 17px; color: #fff; }
        .app-desc { font-size: 12px; color: #8892b0; margin-top: 3px; }

        .btn-install { background: var(--accent); color: #0a192f; padding: 10px 22px; border-radius: 25px; text-decoration: none; font-weight: bold; font-size: 14px; box-shadow: 0 4px 10px rgba(100,255,218,0.2); }
    </style>
</head>
<body>

<header>
    <img src="soul-icon.png" alt="Logo">
    <h1>SOUL PLUS</h1>
    <p style="color:#8892b0; font-size: 13px;">عالم تطبيقات البلس بين يديك</p>
</header>

<div class="app-grid" id="appList">
    <p style="text-align:center; color: var(--accent);">جاري جلب التطبيقات...</p>
</div>

<script>
    // دالة لجلب البيانات من ملف apps.json
    async function getApps() {
        try {
            // إضافة راندوم للرابط عشان نتجنب تعليق النسخة القديمة (Cache)
            const response = await fetch('apps.json?v=' + Math.random());
            if (!response.ok) throw new Error("الملف غير موجود");
            
            const apps = await response.json();
            const list = document.getElementById('appList');
            
            if (apps.length === 0) {
                list.innerHTML = "<p>لا توجد تطبيقات حالياً في المتجر.</p>";
                return;
            }

            // عرض التطبيقات (الأحدث يظهر فوق)
            list.innerHTML = apps.reverse().map(app => `
                <div class="app-card">
                    <div class="app-main">
                        <img src="${app.icon}" class="app-img" onerror="this.src='soul-icon.png'">
                        <div>
                            <div class="app-title">${app.name}</div>
                            <div class="app-desc">${app.desc}</div>
                        </div>
                    </div>
                    <a href="itms-services://?action=download-manifest&url=${app.plist}" 
                       class="btn-install" 
                       onclick="alert('سيتم البدء في التثبيت الآن.. اضغط تثبيت في الرسالة التي ستظهر لك')">
                       تثبيت
                    </a>
                </div>
            `).join('');

        } catch(e) { 
            document.getElementById('appList').innerHTML = "<p style='color:red'>خطأ في تحميل apps.json<br>تأكد أن الملف موجود وبصيغة صحيحة</p>"; 
        }
    }

    // تشغيل الدالة عند فتح الصفحة
    getApps();
</script>
</body>
</html>
